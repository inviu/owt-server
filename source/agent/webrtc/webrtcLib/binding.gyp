{
  'targets': [{
    'target_name': 'webrtc',
    'sources': [
      'addon.cc',
      'AudioFrameConstructorWrapper.cc',
      'AudioFramePacketizerWrapper.cc',
      'VideoFrameConstructorWrapper.cc',
      'VideoFramePacketizerWrapper.cc',
      'WebRtcConnectionAddon.cc',
      "MediaStreamAddon.cc",
      "$(CORE_HOME)/../../third_party/licode/erizoAPI/IOThreadPoolAddon.cc",
      "$(CORE_HOME)/../../third_party/licode/erizoAPI/ThreadPoolAddon.cc",
      'conn_handler/WoogeenHandler.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/DtlsTransport.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/IceConnection.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/LibNiceConnection.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/SdpInfo.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/SrtpChannel.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/Stats.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/StringUtil.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/WebRtcConnection.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/MediaStream.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/lib/LibNiceInterfaceImpl.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread/IOThreadPool.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread/IOWorker.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread/Scheduler.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread/ThreadPool.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread/Worker.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/PacketBufferService.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/RtcpForwarder.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/RtcpProcessorHandler.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/RtpUtils.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/QualityManager.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/RtpExtensionProcessor.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp/BandwidthEstimationHandler.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/dtls/bf_dwrap.c',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/dtls/DtlsClient.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/dtls/DtlsSocket.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/pipeline/Pipeline.cpp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/stats/StatNode.cpp',
      '../../addons/common/NodeEventRegistry.cc',
      '../../../core/owt_base/AudioFrameConstructor.cpp',
      '../../../core/owt_base/AudioFramePacketizer.cpp',
      '../../../core/owt_base/AudioUtilities.cpp',
      '../../../core/owt_base/MediaFramePipeline.cpp',
      '../../../core/owt_base/VideoFrameConstructor.cpp',
      '../../../core/owt_base/VideoFramePacketizer.cpp',
      '../../../core/owt_base/SsrcGenerator.cc',
      '../../../core/rtc_adapter/VieReceiver.cc',
      '../../../core/rtc_adapter/VieRemb.cc' #20150508
    ],
    'defines': [
            'NOMINMAX',
            '_WIN32_WINNT=0x0A00',
            'WIN32_LEAN_AND_MEAN',
            'WEBRTC_WIN',
            'NO_REG_RPC=1', 'HAVE_VFPRINTF=1', 'RETSIGTYPE=void', 'NEW_STDIO', 'HAVE_STRDUP=1', 'HAVE_STRLCPY=1', 'HAVE_LIBM=1', 'HAVE_SYS_TIME_H=1', 'TIME_WITH_SYS_TIME_H=1'
          ],
    "msvs_settings": {
          "VCCLCompilerTool": {
            'RuntimeTypeInfo': 'true',
            "ExceptionHandling": "1",
            'AdditionalOptions': ['/GR','/FI\"winsock2.h\"','/FI\"windows.h\"']
          },
      },
    'cflags_cc': ['-DWEBRTC_POSIX', '-DWEBRTC_LINUX', '-DLINUX', '-DNOLINUXIF', '-DNO_REG_RPC=1', '-DHAVE_VFPRINTF=1', '-DRETSIGTYPE=void', '-DNEW_STDIO', '-DHAVE_STRDUP=1', '-DHAVE_STRLCPY=1', '-DHAVE_LIBM=1', '-DHAVE_SYS_TIME_H=1', '-DTIME_WITH_SYS_TIME_H=1'],
    'include_dirs': [
      "<!(node -e \"require('nan')\")",
      'conn_handler',
      '$(CORE_HOME)/../../third_party',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/lib',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/dtls',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/pipeline',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/rtp',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/thread',
      '$(CORE_HOME)/../../third_party/licode/erizo/src/erizo/stats',
      '../../../core/common',
      '../../../core/owt_base',
      '../../../core/rtc_adapter',
      '../../../../third_party/webrtc/src',
      '../../../../build/libdeps/build/include',
      '../../../../build/libdeps/libnice-0.1.15',
      '../../../../build/libdeps/libnice-0.1.15/agent',
      '../../../../build/libdeps/libnice-0.1.15/glib/include/gio-win32-2.0',
      '../../../../build/libdeps/libnice-0.1.15/glib/include/gnutls',
      '../../../../build/libdeps/libnice-0.1.15/glib/include/glib-2.0',
      'D:/workspace/vcpkg/installed/x64-windows-static/include',
      'D:/workspace/log4cxx/src/apache-log4cxx-0.10.0/src/main/include',
      # '<!@(pkg-config glib-2.0 --cflags-only-I | sed s/-I//g)',
    ],
    'library_dirs': [
      '../../../../build/libdeps/libnice-0.1.15/win32/vs9/libnice/bin/x64_Release',
      '../../../../build/libdeps/libnice-0.1.15/glib/lib',
      '$(CORE_HOME)/../../build/libdeps/build/lib',
      'D:/workspace/log4cxx/src/apache-log4cxx-0.10.0/projects/x64/Release',
      'D:/workspace/vcpkg/installed/x64-windows-static/lib',
    ],
    'libraries': [
      # '-L$(CORE_HOME)/../../build/libdeps/build/lib',
      '-lsrtp2',
      '-llibeay32',
      '-lssleay32',
      '-llog4cxx',
      '-lD:/workspace/vcpkg/installed/x64-windows-static/lib/boost_thread-vc140-mt.lib',
      '-lD:/workspace/vcpkg/installed/x64-windows-static/lib/boost_system-vc140-mt.lib',
      '-llibnice',
      '-lglib-2.0.lib',
      '-lgobject-2.0.lib',
      '-l$(CORE_HOME)/../../third_party/webrtc/webrtc',
      '-l$(CORE_HOME)/../../build/libdeps/build/bin/avutil',
      '-l$(CORE_HOME)/../../build/libdeps/build/bin/avcodec',
      '-l$(CORE_HOME)/../../build/libdeps/build/bin/avformat',
      '-l$(CORE_HOME)/../../build/libdeps/build/bin/swresample',
      '-l$(CORE_HOME)/../../third_party/openh264/openh264',
      '-lWinmm.lib',
    ],
    'conditions': [
      [ 'OS=="mac"', {
        'xcode_settings': {
          'GCC_ENABLE_CPP_EXCEPTIONS': 'YES',        # -fno-exceptions
          'MACOSX_DEPLOYMENT_TARGET':  '10.7',       # from MAC OS 10.7
          'OTHER_CFLAGS': ['-g -O$(OPTIMIZATION_LEVEL) -stdlib=libc++']
        },
      }, { # OS!="mac"
          'cflags!' : ['-fno-exceptions'],
          'cflags' : ['-D__STDC_CONSTANT_MACROS'],
          'cflags_cc' : ['-Wall', '-O3', '-g' , '-std=c++11', '-fexceptions'],
          'cflags_cc!' : ['-fno-exceptions'],
          'cflags_cc!' : ['-fno-rtti']
      }],
    ]
  }]
}
